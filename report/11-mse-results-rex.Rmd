\clearpage

# WEST COAST VANCOUVER ISLAND REX SOLE CASE STUDY {#app:mse-rex}

## BACKGROUND

Rex Sole (*Glyptocephalus zachirus*) occur from central Baja California to the western Bering Sea, and are generally distributed throughout coastal BC [@mecklenburg2002]. They have been caught in BC at depths between 20 m and greater than 1000 m, with most captured between 75 m and 450 m. Rex Sole have been caught in BC waters as large as 58 cm and up to 1.44 kg. The only aged Rex Sole from BC are those caught in the Hecate Strait Multispecies Assemblage Bottom Trawl survey in 1998. The oldest Rex Sole aged from BC was a 34 cm female aged at 15 years, though larger, unaged individuals have been caught up to length 58 cm. This species has been aged up to 29 years (female) in the Gulf of Alaska [@abookire2006]. Additional otoliths have been collected on BC surveys from 2000-present although they have yet to be aged.

Rex Sole are a commonly caught flatfish species in BC groundfish bottom trawl surveys and although it is commonly caught in the commercial mixed-species bottom trawl fishery, there is no directed fishery or assigned quota for it. Rex Sole have never been formally assessed in BC; however, biomass of Rex Sole in Hecate Strait was estimated in 2012 using research survey data collected between 1984 and 2003 [@fargo2012]. 

Commercial and fishery data (catch, lengths, weights, ages, maturity) are available for Rex Sole in DFO databases for analysis as described above for shortraker rockfish. The fishery-independent trawl surveys mentioned above for shortraker have also been capturing and collecting data on Rex Sole and other flatfish since 2003. There is currently no established method for reconstructing historical catches for Rex Sole as has been done for several rockfish species in BC. 

In the US, Rex Sole are caught in the bottom trawl fishery and are considered to form three separate stocks: the Gulf of Alaska stock (GOA), the Bering Sea/Aleutian Islands (BSAI) stock and the west coast stock from Washington to California. The GOA stock is assessed every four years using an age-structured model and was last fully assessed in 2017 [@mcgilliard2017]. The BSAI stock is assessed as part of the "other flatfish complex" of which Rex Sole and starry flounder make up most of the commercial harvest. This stock is also assessed every four years, and was last fully assessed in 2015 [@wilderbuer2015]. The west coast stock was last assessed in 2013 using "extended simple Stock Synthesis" in which a depletion-based stock reduction type analysis is extended to allow index data (and potentially length and age data) to be used for parameter estimation in Stock Synthesis [@cope2015].

\clearpage

(ref:fig-rex-syn1)
First Rex Sole page from @anderson2019synopsis. (Temporary placeholder until we properly plot out just the relevant data.)

```{r rex-syn1, fig.cap="(ref:fig-rex-syn1)", out.width="6in"}
knitr::include_graphics(here::here("images/rex-sole-1.png"))
```

\clearpage

(ref:fig-rex-syn2)
Second Rex Sole page from @anderson2019synopsis. (Temporary placeholder until we properly plot out just the relevant data.)

```{r rex-syn2, fig.cap="(ref:fig-rex-syn2)", out.width="6in"}
knitr::include_graphics(here::here("images/rex-sole-2.png"))
```

\clearpage

*TODO: Complete data information and add figures of catch history and indices of abundance*

<!-- Maturity
Abookire 2006 - GOA ML50 females = 352 mm, ML100 = 420 mm) significantly larger size than in Oregon 
MA50 = 5.1 years, all mature at age 9 except for two still immature at 9 and 10 years (n=557)
Hosie and Horton 1977 - Oregon female ML50 24 cm, ML100 = 30 cm
MA50 = 5 years, MA100 = 9 years (212 females, 45 unsexed age 1 fish)

Mortality
natural mortality used in GOA assessment 0.17-->

*TODO: Flesh out the sections below*

## STEP 1: DEFINE THE DECISION CONTEXT {#sec:results-rex1}

The decision to be made is which MP to use to which MP to use to determine catch
limits for the period until the next available catch advice. The time-frame for making the decision
was stated in the request for science advice. See Section \@ref(sec:approach1).

*TODO: Complete this section after technical team meetings*


## STEP 2: SELECTION OF OBJECTIVES AND PERFORMANCE METRICS  {#sec:results-rex2}

We defined the objectives for Rex Sole to be the same as those listed in Section \@ref(sec:approach2).

The performance metrics measuring the objectives are:

1. LT P40: Probability SB > 0.4 SB~MSY~ (years 36--50)
1. LT P80: Probability SB > 0.8 SB~MSY~ (years 36--50)
1. PNOF: Probability of not overfishing P(F < F~FMSY~) (years 1--50)
1. LTY: Probability yield > 0.5 MSY (years 36--50)
1. STY: Probability yield > 0.5 MSY (years 6--20)
1. AAVY: Probability AAVY (average annual variability in yield) < 0.2 (years 1--50)


## STEP 3: SELECTION OF UNCERTAINTIES/SPECIFICATION OF OPERATING MODELS {#sec:results-rex3}

We consider the major axes of uncertainty for Rex Sole to be:

1. The magnitude of the commercial catch prior to 1996;

2. The value of the steepness parameter (*h*) of the stock-recruit relationship; and

3. The value of natural mortality (*M*).

We defined nine OM scenarios that differed from each other only in these respects (Table \@ref(tab:rex-scen)), with all other parameters held at the same values as described in Appendix \@ref(app:desc-om-rex). 

Prior to 1996, reported catches 

Reference and Robustness scenarios:

```{r rex-scen, results='asis'}
sc <- readRDS(here::here("generated-data/rex-scenarios.rds"))
sc %>% 
  select(-scenario, -order) %>%
csasdown::csas_table(caption = "Rex Sole scenarios")
``` 


```{r rex-survey-fits, fig.cap="Survey fits.", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-index-fits.png"))
```

```{r rex-selectivity, fig.cap="Selectivity from the OM.", out.width="4in"}
knitr::include_graphics(here::here("report/figure/rex-selectivity.png"))
```

\clearpage

(ref:fig-rex-depletion-om)
SSB depeltion trajectories from reference and robustness set OMs.
Some OMs ("M decreasing" and "M increasing") have identical historical trajectories as "Catch eq. 50%", but with a fixed value of M in the historical period (i.e., the change in M only occurs in the projection period).

```{r rex-depletion-om, fig.cap="(ref:fig-rex-depletion-om)", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-compare-SRA-depletion-panel.png"))
```


## STEP 4: IDENTIFICATION OF CANDIDATE MANAGEMENT PROCEDURES  {#sec:results-rex4}

We start with the full set of candidate MPs described in Appendix \@ref(app:MPs):

```{r rex-mps, results='asis'}
mp <- readr::read_csv(here::here("data", "mp.txt"), comment = "#")
mp_list <- split(mp, mp$type)
csasdown::csas_table(mp, caption = "Candidate MPs...")
```

We use the `.` version of the MPs, where applicable, to refer to the version of the MPs that only observes the survey index every second year to mimic our biennial WCVI synoptic survey.

We set a prior on the intrinsic rate of population increase $r$ in the surplus production models based on...

## STEP 5: SIMULATION OF THE APPLICATION OF THE MANAGEMENT PROCEDURES  {#sec:results-rex5}

(ref:fig-rex-converge)
Assessing convergence of the Rex Sole closed-loop simulation under an example OM from the reference set with MPs that are later determined to be part of the satisficed set.
Broad differences between MPs have converged (lines no longer cross each other).
Some MPs with very similar performance may still be exchanging rank order within specific performance metrics as of 200 iterations.
Final inference should probably be drawn on somewhat greater than the 200 iterations shown here.
Other OMs were checked and showed similar patterns.

```{r rex-converge, fig.cap="(ref:fig-rex-converge)", out.width="5in"}
knitr::include_graphics(here::here("report/figure/rex-converge.png"))
```

## STEP 6: PRESENTATION OF RESULTS AND SELECTION OF MANAGEMENT PROCEDURE  {#sec:results-rex6}

### Reference Set Results

(ref:fig-rex-tigure-avg) Average performance of all candidate MPs across the reference set of OMs.
MPs are ordered by decreasing performance metric values from top to bottom starting with the left-most performance metric and using columns from left to right to break any ties.
The color shading reflects the underlying numbers.

```{r rex-tigure-avg, fig.cap="(ref:fig-rex-tigure-avg)", out.width="3.5in"}
knitr::include_graphics(here::here("report/figure/rex-pm-table-avg.png"))
```

(ref:fig-rex-tigure-min) Minimum performance of all candidate MPs across the reference set of OMs.
This figure is the same as Figure \@ref(fig:rex-tigure-avg) but shows the **minimum** performance metric across the OMs in the reference set for the purposes of applying satisficing rules.
In other words, this figure illustrates the worst performance of each MP across the reference set of OMs.

```{r rex-tigure-min, fig.cap="(ref:fig-rex-tigure-min)", out.width="3.5in"}
knitr::include_graphics(here::here("report/figure/rex-pm-table-min.png"))
```

\clearpage

(ref:fig-rex-tigure-panel) Performance of satisficed MPs for the reference set OMs.
MPs are ordered by decreasing performance metric values from the averaged reference set (Figure \@ref(fig:rex-tigure-min).

```{r rex-tigure-panel, fig.cap="(ref:fig-rex-tigure-panel)", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-pm-tigures-ref-set.png"))
```

\clearpage

```{r rex-spider-all-mps, fig.cap="Spider plots of performance metric trade-offs amongst all MPs for the averaged reference set of OMs. Each spoke of the web represents a performance metric and each line represents a management procedure. Lines closer to the outside of the web correspond to MPs that are determined to have a higher probability of achieving that performance metric.", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-spider-all-mptypes-avg-panel.png"))
```

\clearpage

```{r rex-spider-satisficed-mps-avg, fig.cap="Average performance metrics for satisficed MPs for the reference set of OMs.", out.width="5in"}
knitr::include_graphics(here::here("report/figure/rex-spider-satisficed-avg.png"))
```

\clearpage

(ref:fig-rex-spider-satisficed-mps-reference)
Performance metrics for satisficed MPs for the individual OMs in the reference set. Colours are the same as for Figure \@ref(fig:rex-spider-satisficed-mps-avg).

```{r rex-spider-satisficed-mps-reference, fig.cap="(ref:fig-rex-spider-satisficed-mps-reference)", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-spider-satisficed-panel.png"))
```

\clearpage

(ref:fig-rex-proj-ceq100) Historical and projected SSB/SSB~MSY~, F/F~MSY~, and catch across satisficed and reference MPs and the "Catch eq. 100%" OM.
Dark line indicates the median value and the darker and lighter shaded ribbons indicate the 50% and 90% quantiles.
Thin gray lines represent illustrative simulation iterations.
The vertical dashed line indicates the last year of the historical period.
The horizontal dashed lines indicate SSB/SSB~MSY~ = 1, 0.8, and 0.4; F/F~MSY~ = 1; and catch = catch from the last historical year.

```{r rex-proj-ceq100, fig.cap="(ref:fig-rex-proj-ceq100)", out.width="6.5in"}
knitr::include_graphics(here::here("report/figure/rex-projections-satisficed-ceq100.png"))
```

(ref:fig-rex-proj-ceq200-cpue) Same as Figure \@ref(fig:rex-proj-ceq100) but for the OM "Catch 200% + CPUE".

```{r rex-proj-ceq200-cpue, fig.cap="(ref:fig-rex-proj-ceq200-cpue)", out.width="6.5in"}
knitr::include_graphics(here::here("report/figure/rex-projections-satisficed-ceq200-cpue.png"))
```

(ref:fig-rex-proj-low-h) Same as Figure \@ref(fig:rex-proj-ceq100) but for the OM "h = 0.5--0.7". (Other similar projection plots would be included but are not included in this draft.)

```{r rex-proj-low-h, fig.cap="(ref:fig-rex-proj-low-h)", out.width="6.5in"}
knitr::include_graphics(here::here("report/figure/rex-projections-satisficed-low-h.png"))
```

\clearpage

(ref:fig-rex-proj-failed) Historical and projected SSB/SSB~MSY~, F/F~MSY~, and catch for the base OM across example MPs that did **not** pass the satisficing criteria. In cases where similar MPs existed but had similar performance, only one is shown as an example (e.g., for .IDX and .IDX_smooth, only .IDX_smooth is shown).
Caption is otherwise the same as Figure \@ref(fig:rex-proj-ceq100).

```{r rex-proj-failed, fig.cap="(ref:fig-rex-proj-failed)", out.width="6.5in"}
knitr::include_graphics(here::here("report/figure/rex-projections-eg-NOT-satisficed-ceq50.png"))
```

\clearpage

(ref:fig-rex-kobe) SSB/SSB~MSY~ and F/F~MSY~ values from the final year of the projections across all iterations for the "Catch eq. 100%" OM. 
Dots represent individual iterations.
Contour lines indicate two-dimensional kernel-density-smoothed quantiles at 0.10, 0.25, and 0.50 levels, calculated in log space.

```{r rex-kobe, fig.cap="(ref:fig-rex-kobe)", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-kobe-satisficed-ceq100.png"))
```

\clearpage

(ref:fig-rex-worm) Trajectory of SSB/SSB~MSY~ and F/F~MSY~ values summarized across iterations for the "Catch eq. 100%" OM.
The solid line corresponds to the median value.
Each diamond represents the 80% quantile of B/B~MSY~ (horizontal) and F/F~MSY~ (vertical).

```{r rex-worm, fig.cap="(ref:fig-rex-worm)", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-neon-worms-base.png"))
```

\clearpage

### Robustness Set Results

```{r rex-spider-satisficed-mps-robust, fig.cap="Performance metrics for satisficed MPs for the individual OMs in the robustness set.", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-spider-satisficed-panel-robust.png"))
```

\clearpage

(ref:fig-rex-tigure-panel-rob) Performance of satisficed MPs for the robustness set OMs.

```{r rex-tigure-panel-rob, fig.cap="(ref:fig-rex-tigure-panel-rob)", out.width="5in"}
knitr::include_graphics(here::here("report/figure/rex-pm-tigures-rob-set.png"))
```


\clearpage

### Sensitivity Tests

(ref:fig-rex-sens-bbmsy) 
The sensitivity of SSB/SSB~MSY~ in years 36--50 of the projection (y-axis) to OM parameter values (x-axis).
This example uses the "Catch eq. 100%" OM.
A variety of MPs are illustrated across rows.
Each point corresponds to simulation iteration and the solid lines correspond to a loess smoother.

```{r rex-sens-bbmsy, fig.cap="(ref:fig-rex-sens-bbmsy)", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-sensitivity-bbmsy-base.png"))
```

(ref:fig-rex-sens-yield)
Same as Figure \@ref(fig:rex-sens-bbmsy) but for mean yield in years 6--20 of the projection.

```{r rex-sens-yield, fig.cap="(ref:fig-rex-sens-yield)", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-sensitivity-yield-base.png"))
```

\clearpage

(ref:fig-rex-proj-sens-bbmsy) 
The sensitivity of SSB/SSB~MSY~ (y-axis) to high and low values (colours) of various OM parameters (columns) over time.
This example uses the "Catch eq. 100%" OM.

```{r rex-proj-sens-bbmsy, fig.cap="(ref:fig-rex-proj-sens-bbmsy)", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-sensitivity-traj-bbmsy-base.png"))
```

\clearpage

(ref:fig-rex-proj-sens-ffmsy) 
The sensitivity of F/F~MSY~ (y-axis) to high and low values (colours) of various OM parameters (columns) over time.
This example uses the "Catch eq. 100%" OM.

```{r rex-proj-sens-ffmsy, fig.cap="(ref:fig-rex-proj-sens-ffmsy)", out.width="\\textwidth"}
knitr::include_graphics(here::here("report/figure/rex-sensitivity-traj-ffmsy-base.png"))
```
