\newpage

# Management Procedures

This is a generic review of the available MPs in DLMtool which include TAC-based procedures.

```{r, results='asis', include=FALSE}
mps <- DLMtool::MPtype(DLMtool::avail('MP')) %>%
  dplyr::filter(Recs == "TAC") %>% 
  dplyr::filter(!MP %in% grep("CC[2-9]+", .$MP, value = TRUE) )
csasdown::csas_table(mps)
```

### `AvC`: Average catch

The mean historical catch is calculated and used to set a constant catch limit (TAC). The TAC is calculated as:

$$
\textrm{TAC} = \frac{\sum_{y=1}^{n}C_y}{n}
$$

where $\mathrm{TAC}$ is the catch recommendation, $n$ is the number of historical years, and $C_y$ is the catch in historical year $y$.

### `BK_ML`: Beddington and Kirkwood life-history

An MP that sets the TAC based on an approximation of $F_\textrm{max}$ based on the length at first capture relative to the asymptotic length and the von Bertalanffy growth parameters $K$.  $F_\textrm{max}$ is the fishing mortality that produces the maximum yield assuming constant recruitment independent of spawning biomass. The TAC is calculated as

$$
\textrm{TAC} = A F_{\textrm{max}},
$$

where $A$ is vulnerable stock abundance, and $F_{\textrm{max}}$ is calculated as

$$
F_{\textrm{max}} = \frac{0.6K}{0.67-L_c/L_\infty},
$$

where $K$ is the von Bertalanffy growth coefficient, $L_c$ is the length at first capture, and $L_\infty$ is the von Bertalanffy asymptotic length.

Abundance ($A$) is estimated as

$$
A = \frac{\bar{C}}{\left(1-e^{-F}\right)},
$$

where $\bar{C}$ is the mean catch, and $F$ is estimated using mean length data. Specifically, total mortality $Z$ is estimated as and $F$ as calculated as $Z$ - $M$, where $M$ it is assumed known. 

### `CC`: Constant catch

The TAC is the average historical catch over the last $n$ years (default 5) [@geromont2015]. The TAC is calculated as:

$$
\textrm{TAC} = (1-x)C_{\textrm{ave}}
$$

where $x$ lies between 0 and 1, and $C_\textrm{ave}$ is average historical catch over the previous $n$ years (default of five). The TAC is constant for all future projections. CC1, CC2, CC3, CC4, and CC5 represent the same MP but with $x =$ 0.9, 0.8, 0.7, and 0.6 respectively.

FIXME: add how mean length data are used to estimate Z and F.


### `DD`: Delay Difference

A simple delay-difference assessment with $U_\textrm{MSY}$ and MSY as leading parameters that estimate the TAC using a time-series of catch. This model includes observation error only and has does not estimate process error (recruitment deviations). There is the assumption that knife-edge selectivity occurs at the age of 50. It depends on other assumptions such as temporally stationary productivity and proportionality between the abundance index and real abundance. The extent to which these assumptions are violated tends to be the biggest driver of performance for this method. See @carruthers2012 and @hilborn1992\.

$$
\textrm{TAC} = U_\textrm{MSY} * \textrm{Current Biomass}
$$

DD4010 imposes the 40:10 rule on the TAC.


### `Fratio_ML`: $F_\textrm{MSY}/M$ ratio method using mean lengths

Calculates the overfishing limit based on a fixed ratio of FMSY to M multiplied by a current estimate of abundance. This method estimates current abundance by using average catch and an estimate of F from mean lengths. See @gulland1971 and @martell2013\.

$$
TAC = F_\textrm{MSY}A
$$

where $F_\textrm{MSY}$ is calculated as $\frac{F_\textrm{MSY}}{M}M$ and $A$ is an estimate of current abundance.

### `Fdem_ML`: Demographic $F_\textrm{MSY}$ method using mean lengths

$F_\textrm{MSY}$ is calculated as $r/2$ where $r$ is calculated from a demographic approach (including steepness). This is coupled with an estimate of current abundance using mean lengths that gives you the overfishing limit (OFL).

$$
TAC = F_\textrm{MSY}A
$$

where $A$ is an estimate of current abundance, and $F_\textrm{MSY}$ is estimated as $r/2$, where $r$ is the intrinsic rate of population growth, estimated from the life-history parameters using the methods of @mcallister2001\.

### `GB_CC`: Geromont and Butterworth Constant Catch

A simple MP that aims for a reference catch (as a proxy for MSY) subject to imperfect information. The TAC is calculated to be equivalent to a reference catch which is assumed to be a proxy for MSY.

$$
TAC = C_{ref}
$$

where $C_{ref}$ s a reference catch assumed to be a proxy for MSY. In the MSE $C_{ref}$ is the calculated MSY subject to observation error. See @geromont2015\.

The TAC is subject to the following conditions:

- if next TAC > 1.2 last catch, then $TAC = 1.2 * \textrm{last catch}$
- if next TAC < 0.8 last catch, then $TAC = 0.8 * \textrm{last catch}$

### `GB_slope`: Geromont and Butterworth index Slope HCR

An MP similar to SBT1 that modifies a time-series of catch recommendations and aims for a stable catch rates.

$$
\textrm{TAC}_y= C_{y-1}(1+\lambda I)
$$

where where $C_{y-1}$ is catch from the previous year, $\lambda$ is a gain parameter, and $I$ is the slope of the linear regression of log Index over the last 5 years.

The TAC is subject to the following conditions:

- if next TAC > 1.2 last catch, then $TAC = 1.2 * \textrm{last catch}$
- if next TAC < 0.8 last catch, then $TAC = 0.8 * \textrm{last catch}$

See @geromont2015 for more information.

### `GB_target`: Geromont and Butterworth target CPUE and catch

An MP similar to SBT2 that modifies a time-series of catch recommendations and aims for target catch rate and catch level based on $B\{MSY}/B_0$ and MSY, respectively.

If $I_{recent}\ge I_0$ the TAC is:
$$
\textrm{TAC}= C_\textrm{ref}(w + (1-w)\frac{I_\textrm{rec}-I_0}{I_\textrm{target}-I_0})
$$

otherwise:

$$
\textrm{TAC}= wC_\textrm{ref} \frac{I_\textrm{rec}}{I_0}^2
$$
where $C_\textrm{ref}$ is a reference catch assumed to be a proxy for MSY, $w$ is a gain parameter, $I_\textrm{rec}$ is the average index over the last 4 years, $I\textrm{target}$ is the target Index, and $I_0$ is 0.2 x the average index over the past 5 years.

In the MSE $C_\textrm{ref}$ is the calculated MSY subject to observation error, and $I\textrm{target}$ is assumed to be the index at MSY subject to observation error. Consequently, the performance of this method in the MSE is strongly determined by the specified uncertainty for these parameters.

The TAC is subject to the following conditions:

- if next TAC > 1.2 last catch, then $TAC = 1.2 * \textrm{last catch}$
- if next TAC < 0.8 last catch, then $TAC = 0.8 * \textrm{last catch}$

### `ICI`: Index Confidence Interval

The MP adjusts catch based on the value of the index in the current year relative to the time series mean and standard error.

$$
\textrm{TAC}_y=C_{y-1} \alpha
$$

where $C_{y-1}$ is the catch from the previous year, and $\alpha$ is defined as:

$$
\alpha = 
\begin{cases}
d, & \text{if}\ I \lt CI_L \\
u, & \text{if}\ I \gt CI_H \\
1, & \text{if}\ CI_L \le I \le CI_H
\end{cases}
$$

where $I$ is the index in the most recent year, $d$ is 0.75 for both ICI and ICI2, $u$ is 1.05 and 1.25 for ICI and ICI2 respectively, and $CI_L$ and $CI_H$ are the lower and upper bound of the confidence interval of mean historical index. The confidence interval is calculated using Z-scores as follows:

- ICI: The catch is reduced by 0.75 if the Z-score of the current year's index is less than -0.44. The catch is increased by 1.05 if the Z-score of the current year's index is greater than 1.96. Otherwise, the catch is held constant.
- ICI2: This method is less precautionary of the two ICI MPs by allowing for a larger increase in TAC and a lower threshold of the index to decrease the TAC. The catch is reduced by 0.75 if the Z-score of the current year's index is less than -1.96. The catch is increased by 1.25 if the Z-score of the current year's index is greater than 1.96. Otherwise, the catch is held constant.

See @jardim2015 for more information.

### `Iratio`: Mean Index ratio

The TAC is adjusted by the ratio $\alpha$, where the numerator being the mean index in the most recent two years of the time series and the denominator being the mean index in the three years prior to those in the numerator. This MP is the stochastic version of Method 3.2 used by ICES for Data-Limited Stocks (@ices2012).

$$
\textrm{TAC}_y = \alpha C_{y-1}
$$

where $C_{y−1}$ is the catch from the previous year, and $\alpha$ is the ratio of the mean index in the most recent two years of the time series and the mean index in 3--5 years before current time. The number of reference years can be specified.
$\alpha$ is defined as

$$
\alpha = \frac{\frac{I_{yr-1} + I_{yr-2}} {2}} {\frac{I_{yr-3} + I_{yr-4} + I_{yr-5}} {3}}
$$

See @jardim2015 for more information.

### `Islope`: Index slope tracking

A management procedure that incrementally adjusts the TAC to maintain a constant CPUE or relative abundance index.

$$
\textrm{TAC} = \textrm{TAC}^*(1+\lambda I)
$$

where $TAC^∗$ is $1−xx$ multiplied by the mean catch from the past 5 years for the first year and catch from the previous year in projection years, $\lambda$ is a gain parameter, and $I$ is the slope of log index over the past 5 years.
Islope1, Islope2, and Islope3 increase in being biological precautionary by having values for $xx$ of 0.2, 0.3, and 0.4 respectively. Islope4 is considered the most biologically precautionary as it is identical to Islope3 but with a reduced gain parameter, $\lambda$ of 0.2 while the others use 0.4.



-----
